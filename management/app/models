from . import db

class User(db.model):
    __tablename__ = 'user'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String)
    phone = db.Column(db.String, unique=True)
    email = db.Column(db.String, unique=True)
    area = db.Column(db.Integer)
    service = db.relationship('Task', backref='user')
    freetime = db.Column(db.PickleType)

    def __repr__(self):
         return '<User %r>' % self.name

class Worker(db.model):
    __tablename__ = 'worker'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String)
    phone = db.Column(db.String, unique=True)
    email = db.Column(db.String, unique=True)
    area_in_duty = db.Column(db.PickleType)
    tasks = db.relationship('Task', backref='worker')
    worktime = db.Column(db.PickleType)
    arranged = db.Column(db.PickleType)

    def __repr__(self):
         return '<Worker %r>' % self.name
class Task(db.model):
    __tablename__ = 'task'
    id = db.Column(db.Integer, primary_key=True)
    area = db.Column(db.Integer)
    task_type = db.Column(db.Integer)
    user = db.Column(db.Integer, db.ForeignKey('user.id'))
    submmit_time = db.Column(db.DateTime)
    worker = db.Column(db.Integer, db.ForeignKey('worker.id'))
    details = db.Column(db.Text)
    chage_log = db.Column(db.PickleType)
    is_push = db.Column(db.Boolean)
    change_push = db.Column(db.Boolean)

class Notice(db.model):
    __tablename__ = 'notice'
    id = db.Column(db.Integer, primary_key=True)
    time = db.Column(db.DateTime)
    author = db.Column(db.Integer, db.ForeignKey('admin.id'))
    title = db.Column(db.String, nullable=False)
    text = db.Column(db.Text)

class Admin(db.model):
    __tablename__ = 'admin'
    id = db.Column(db.Integer, primary_key=True)
    password = db.Column(db.String, nullable=False)
    authority = db.Column(db.Integer)    
